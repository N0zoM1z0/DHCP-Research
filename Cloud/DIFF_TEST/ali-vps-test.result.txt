
[===] 开始测试目标: VPS DHCP (网卡: eth0) [===]

[>>>] 正在执行测试套件: '标准DORA流程' [<<<]

================================================================================
DHCP 测试报告: 标准DORA流程
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
completeness_score       : 8
lease_time               : 1892160000
missing_options          : ['DNS服务器']
name_server              : N/A
router                   : 172.21.127.253
server_ip                : 172.21.127.253
subnet_mask              : 255.255.240.0

--- DHCP服务完整性分析 ---
完整性得分: 8/10
缺少选项: DNS服务器
================================================================================

[>>>] 正在执行测试套件: 'Option 12 主机名测试' [<<<]

================================================================================
DHCP 测试报告: Option 12 主机名测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
dns_registered           : 否
hostname                 : my-test-pc
resolved_ip              : N/A
server_ip                : 172.21.127.253
================================================================================

[>>>] 正在执行测试套件: 'Option 81 FQDN测试' [<<<]

================================================================================
DHCP 测试报告: Option 81 FQDN测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
dns_registered           : 否
fqdn                     : my-fqdn-pc.local
option81_support         : 否
resolved_ip              : N/A
server_ip                : 172.21.127.253
================================================================================

[>>>] 正在执行测试套件: 'Option 114 强制门户测试' [<<<]

================================================================================
DHCP 测试报告: Option 114 强制门户测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
option114_content        : N/A
option114_in_ack         : 否
option114_support        : 否
server_ip                : 172.21.127.253
================================================================================

[>>>] 正在执行测试套件: 'Option 121 静态路由测试' [<<<]

================================================================================
DHCP 测试报告: Option 121 静态路由测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
option121_in_ack         : 否
option121_support        : 否
server_ip                : 172.21.127.253
static_routes            : N/A
================================================================================

[>>>] 正在执行测试套件: '健壮性-未知选项测试' [<<<]

================================================================================
DHCP 测试报告: 健壮性-未知选项测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
response_type            : ACK
robustness_score         : 10
unknown_option_tolerance : 高 (优雅地忽略未知选项)
================================================================================

[>>>] 正在执行测试套件: '健壮性-畸形选项测试' [<<<]

================================================================================
DHCP 测试报告: 健壮性-畸形选项测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
hostname_in_ack          : 选项被忽略
malformed_option_handling: 谨慎 (接受请求但忽略了畸形选项)
robustness_score         : 9
================================================================================

[>>>] 正在执行测试套件: 'Option 61 客户端标识符测试' [<<<]

================================================================================
DHCP 测试报告: Option 61 客户端标识符测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
client_id_priority       : 使用客户端标识符 (Option 61) 作为主要标识
custom_id_support        : 是
identification_policy    : 基于客户端标识符
mac_change_handling      : 接受
option61_support         : 是
server_ip                : 172.21.127.253
standard_id_support      : 是
================================================================================

[>>>] 正在执行测试套件: 'Option 60 厂商类型标识符测试' [<<<]
  -- 测试厂商标识: MSFT 5.0
  -- 测试厂商标识: android-dhcp-10
  -- 测试厂商标识: HUAWEI:STB
  -- 测试厂商标识: IPTV_STB
  -- 测试厂商标识: ArubaAP
  -- 测试厂商标识: udhcp 1.19.4

================================================================================
DHCP 测试报告: Option 60 厂商类型标识符测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
analysis                 : []
option43_responses       : {}
option43_support         : 否
special_vci_handling     : 否
test_details             : {'MSFT 5.0': {'status': '成功', 'assigned_ip': '172.21.124.144', 'server_ip': '172.21.127.253', 'vci': 'MSFT 5.0', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'android-dhcp-10': {'status': '成功', 'assigned_ip': '172.21.124.144', 'server_ip': '172.21.127.253', 'vci': 'android-dhcp-10', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'HUAWEI:STB': {'status': '成功', 'assigned_ip': '172.21.124.144', 'server_ip': '172.21.127.253', 'vci': 'HUAWEI:STB', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'IPTV_STB': {'status': '成功', 'assigned_ip': '172.21.124.144', 'server_ip': '172.21.127.253', 'vci': 'IPTV_STB', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'ArubaAP': {'status': '成功', 'assigned_ip': '172.21.124.144', 'server_ip': '172.21.127.253', 'vci': 'ArubaAP', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'udhcp 1.19.4': {'status': '成功', 'assigned_ip': '172.21.124.144', 'server_ip': '172.21.127.253', 'vci': 'udhcp 1.19.4', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}}
vci_handling_description : 路由器接受所有VCI但没有特殊处理
vci_tests_total          : 6
vci_with_option43_responses: 0
================================================================================

[>>>] 正在执行测试套件: 'Option 43 厂商特定信息测试' [<<<]
  -- 测试VCI与Option 43关联: MSFT 5.0
  -- 测试VCI与Option 43关联: IPTV_STB
  -- 测试VCI与Option 43关联: HUAWEI:STB
  -- 测试VCI与Option 43关联: ArubaAP
  -- 测试VCI与Option 43关联: Cisco Systems
  -- 测试VCI与Option 43关联: VOIP
  -- 测试VCI与Option 43关联: UBNT
  -- 测试VCI与Option 43关联: HP AP
  -- 测试VCI与Option 43关联: TP-LINK

================================================================================
DHCP 测试报告: Option 43 厂商特定信息测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
analysis                 : 路由器不对任何测试的厂商ID返回特定信息
option43_responses       : {}
option43_support         : 否
responsive_vci_count     : 0
responsive_vcis          : []
test_details             : {'MSFT 5.0': {'status': '成功', 'vci': 'MSFT 5.0', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'IPTV_STB': {'status': '成功', 'vci': 'IPTV_STB', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'HUAWEI:STB': {'status': '成功', 'vci': 'HUAWEI:STB', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'ArubaAP': {'status': '成功', 'vci': 'ArubaAP', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'Cisco Systems': {'status': '成功', 'vci': 'Cisco Systems', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'VOIP': {'status': '成功', 'vci': 'VOIP', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'UBNT': {'status': '成功', 'vci': 'UBNT', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'HP AP': {'status': '成功', 'vci': 'HP AP', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'TP-LINK': {'status': '成功', 'vci': 'TP-LINK', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}}
vci_tested               : 9
================================================================================

[>>>] 正在执行测试套件: 'Option 42 NTP服务器测试' [<<<]

================================================================================
DHCP 测试报告: Option 42 NTP服务器测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
ntp_analysis             : 未提供NTP服务器
ntp_count                : 0
ntp_server_count         : 0
ntp_servers              : N/A
option42_in_ack          : 否
option42_in_offer        : 否
option42_support         : 否
server_ip                : 172.21.127.253
================================================================================

[>>>] 正在执行测试套件: 'Option 66/67 PXE引导测试' [<<<]

================================================================================
DHCP 测试报告: Option 66/67 PXE引导测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
bootfile_name            : N/A
bootp_file_used          : 否
bootp_siaddr_used        : 否
option66_in_ack          : 否
option66_in_offer        : 否
option66_support         : 否
option67_in_ack          : 否
option67_in_offer        : 否
option67_support         : 否
pxe_support_level        : 无
server_ip                : 172.21.127.253
tftp_server              : N/A
================================================================================

[>>>] 正在执行测试套件: 'Option 57 最大消息大小测试' [<<<]

================================================================================
DHCP 测试报告: Option 57 最大消息大小测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
ack_size                 : 590
assigned_ip              : 172.21.124.144
compliance_details       : 完全忽略最大消息大小限制
max_size_declared        : 300
offer_size               : 590
option57_compliance      : 不遵循
option_count             : 7
respects_max_size_ack    : 否
respects_max_size_offer  : 否
server_ip                : 172.21.127.253
size_optimization        : 是
================================================================================

[>>>] 正在执行测试套件: 'Option 82 中继代理信息测试' [<<<]

================================================================================
DHCP 测试报告: Option 82 中继代理信息测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
option82_handling        : 忽略 (Strip)
option82_in_ack          : 否
option82_in_offer        : 否
security_posture         : 一般 (接受但不回显，属于宽容模式)
security_score           : 5
server_ip                : 172.21.127.253

--- 安全性分析 ---
安全评分: 5/10
================================================================================

[>>>] 正在执行测试套件: '租约操纵-伪造释放测试' [<<<]
  -- 使用伪造MAC 3e:0d:0a:8b:ad:4c 尝试释放IP 172.21.124.144

================================================================================
DHCP 测试报告: 租约操纵-伪造释放测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
fake_mac_used            : 3e:0d:0a:8b:ad:4c
ip_after_spoof           : 172.21.124.144
original_ip              : 172.21.124.144
same_ip_reused           : 是
security_posture         : 安全 (服务器忽略了来自错误MAC的Release请求)
security_score           : 10
spoof_release_vulnerable : 否

--- 安全性分析 ---
安全评分: 10/10
================================================================================

[>>>] 正在执行测试套件: '资源耗尽-DHCP饥饿攻击测试' [<<<]
  -- 开始执行饥饿攻击测试，将尝试 30 次...
  -- 已完成 5/30 次攻击，成功消耗了 5 个IP地址
  -- 已完成 10/30 次攻击，成功消耗了 10 个IP地址
  -- 已完成 15/30 次攻击，成功消耗了 15 个IP地址
  -- 已完成 20/30 次攻击，成功消耗了 20 个IP地址
  -- 已完成 25/30 次攻击，成功消耗了 25 个IP地址
  -- 已完成 30/30 次攻击，成功消耗了 30 个IP地址
  -- 饥饿攻击测试完成，成功消耗了 30 个IP地址
  -- 分配的IP范围: 172.21.124.144 - 172.21.124.144
  -- 使用真实MAC 00:16:3e:08:47:fe 尝试获取IP...

================================================================================
DHCP 测试报告: 资源耗尽-DHCP饥饿攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
allocated_ips_sample     : ['172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144']
assigned_ip              : 172.21.124.144
consumed_ip_count        : 30
ip_recycling_mechanism   : 是
ip_reused_from_attack    : 是
legit_client_got_ip      : 是
resilience_score         : 10
reuse_detail             : 服务器回收并重用了攻击者获取的IP
starvation_resilience    : 高 (在攻击后合法客户端仍能获取IP)
starvation_test_result   : 服务器具有攻击抵抗力
starvation_vulnerable    : 否

--- 安全性分析 ---
抵抗力评分: 10/10
================================================================================

[>>>] 正在执行测试套件: 'Option 50 客户端指定IP测试' [<<<]
  -- 第一次获取到IP: 172.21.124.144
  -- 已释放IP 172.21.124.144
  -- 尝试在DISCOVER中请求特定IP: 172.21.124.144
  -- 尝试在DISCOVER中请求边界IP: 172.21.124.244

================================================================================
DHCP 测试报告: Option 50 客户端指定IP测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
edge_request_successful  : 是
honored_edge_request     : 否
offered_edge_ip          : 172.21.124.144
option50_policy          : 尊重客户端请求 (分配了请求的IP)
policy_detail            : 服务器接受客户端建议的IP，但仅限于合理范围内
policy_score             : 5
reference_ip             : 172.21.124.144
request_honored          : 是
requested_edge_ip        : 172.21.124.244
requested_ip             : 172.21.124.144
security_posture         : 中等 (接受先前分配的IP建议)
security_score           : 6

--- 安全性分析 ---
安全评分: 6/10
策略评分: 5/10
================================================================================

[>>>] 正在执行测试套件: 'Option 80 快速提交测试' [<<<]
  -- 等待服务器响应，可能是标准的OFFER或直接ACK...
  -- 收到DHCP OFFER，服务器不支持Rapid Commit

================================================================================
DHCP 测试报告: Option 80 快速提交测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
dora_steps               : 4步 (标准DORA)
efficiency_optimization  : 无
note                     : 服务器不支持Rapid Commit，使用了标准的DORA流程
option80_support         : 否
performance_rating       : 5
rapid_commit_enabled     : 否
================================================================================

[>>>] 正在执行测试套件: 'Option 77 用户类别测试' [<<<]
  -- 基准测试: 获得IP 172.21.124.144
  -- 测试用户类: guest
  -- 测试用户类: gaming
  -- 测试用户类: streaming
  -- 测试用户类: iot
  -- 测试用户类: voice
  -- 测试用户类: admin
  -- 测试用户类: work-from-home

================================================================================
DHCP 测试报告: Option 77 用户类别测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
base_ip                  : 172.21.124.144
option77_support         : 否
special_policies_found   : 0
special_user_classes     : []
user_class_responses     : {'guest': {'status': '标准策略', 'assigned_ip': '172.21.124.144', 'note': '与基准配置相同'}, 'gaming': {'status': '标准策略', 'assigned_ip': '172.21.124.144', 'note': '与基准配置相同'}, 'streaming': {'status': '标准策略', 'assigned_ip': '172.21.124.144', 'note': '与基准配置相同'}, 'iot': {'status': '标准策略', 'assigned_ip': '172.21.124.144', 'note': '与基准配置相同'}, 'voice': {'status': '标准策略', 'assigned_ip': '172.21.124.144', 'note': '与基准配置相同'}, 'admin': {'status': '标准策略', 'assigned_ip': '172.21.124.144', 'note': '与基准配置相同'}, 'work-from-home': {'status': '标准策略', 'assigned_ip': '172.21.124.144', 'note': '与基准配置相同'}}
user_class_sensitivity   : 无
user_classes_tested      : 7
================================================================================

[>>>] 正在执行测试套件: 'Option 33 静态路由(旧)测试' [<<<]

================================================================================
DHCP 测试报告: Option 33 静态路由(旧)测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
backward_compatibility   : 低
code_age                 : 现代 (仅支持Option 121)
code_age_details         : 路由器DHCP服务不支持老式Option 33，可能是较新的代码库
option33_in_ack          : 否
option33_support         : 否
server_ip                : 172.21.127.253
static_routes            : N/A
================================================================================

[>>>] 正在执行测试套件: 'Option 119 域名搜索列表测试' [<<<]

================================================================================
DHCP 测试报告: Option 119 域名搜索列表测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 172.21.124.144
dns_flexibility          : 低
dns_integration          : 低
domain_name              : N/A
domain_search_list       : N/A
multi_domain_support     : 否
option119_support        : 否
option15_support         : 否
server_ip                : 172.21.127.253
================================================================================

[>>>] 正在执行测试套件: '租约续订时序攻击测试' [<<<]
  -- 成功获取IP: 172.21.124.144
  -- 租约时间: 1892160000秒
  -- 标准续约时间点T1: 946080000.0秒后
  -- 但我们将在获取IP后立即尝试续约...
  -- 监听网络以捕获现有DHCP客户端信息...
  -- 未能通过监听捕获到DHCP客户端，尝试其他方式...
  -- 找到受害者客户端: IP=172.21.124.57, MAC=ee:ff:ff:ff:ff:ff
  -- 服务器IP: 172.21.124.1
  -- 发送伪造的续约请求 (XID: 0x58450e23)

================================================================================
DHCP 测试报告: 租约续订时序攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
early_renewal_details    : {'status': '成功', 'assigned_ip': '172.21.124.144', 'lease_time': 1892160000, 'renewal_response': '无响应', 'early_renewal_permitted': '否', 'timing_strictness': '高 (忽略过早续约请求)', 'timing_security': '高', 'time_validation': '是', 'notes': '服务器正确忽略了过早的续约请求，这符合最佳安全实践'}
early_renewal_permitted  : 否
overall_renewal_security : 高
source_validation        : 是
space_security_level     : 高
spoofed_renewal_details  : {'status': '成功', 'spoofed_ip': '172.21.124.57', 'spoofed_mac': 'ee:ff:ff:ff:ff:ff', 'renewal_response': '无响应', 'spoofing_possible': '否', 'source_validation': '是', 'security_level': '高', 'notes': '服务器正确地忽略了来自错误源的续约请求'}
spoofing_possible        : 否
time_security_level      : 高
time_validation          : 是
================================================================================

[>>>] 正在执行测试套件: '跨子网IP请求测试' [<<<]
  -- 标准DISCOVER获得IP: 172.21.124.144
  -- 当前网络前缀: 172.21.124
  -- 测试伪造中继IP: 172.16.0.1
  -- 测试伪造中继IP: 172.31.0.1
  -- 测试伪造中继IP: 10.1.1.1
  -- 测试伪造中继IP: 192.168.10.1

================================================================================
DHCP 测试报告: 跨子网IP请求测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
security_notes           : 服务器正确拒绝了所有伪造中继的请求
standard_network         : 172.21.124
subnet_leakage_detected  : 否
test_details             : [{'fake_relay': '172.16.0.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}, {'fake_relay': '172.31.0.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}, {'fake_relay': '10.1.1.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}, {'fake_relay': '192.168.10.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}]
tested_relay_ips         : ['172.16.0.1', '172.31.0.1', '10.1.1.1', '192.168.10.1']
topology_security_level  : 高
================================================================================

[>>>] 正在执行测试套件: 'BOOTP遗留协议回退测试' [<<<]

================================================================================
DHCP 测试报告: BOOTP遗留协议回退测试
================================================================================
测试状态: 失败
失败原因: 未收到BOOTP响应

[>>>] 正在执行测试套件: '选项重载字段损坏攻击' [<<<]

================================================================================
DHCP 测试报告: 选项重载字段损坏攻击
================================================================================
测试状态: 成功

--- 详细测试结果 ---
parser_robustness        : 高
security_assessment      : 服务器对DHCP选项溢出攻击具有良好的防御能力
server_crashed           : 否
tests_passed             : 5
tests_run                : 5
vulnerabilities          : []
================================================================================

[>>>] 正在执行测试套件: 'IP分片攻击' [<<<]

================================================================================
DHCP 测试报告: IP分片攻击
================================================================================
测试状态: 发现异常
失败原因: Unknown

[>>>] 正在执行测试套件: 'DHCP服务器状态机安全测试' [<<<]
[*] 开始在接口 eth0 上进行DHCP状态机安全测试...

[*] 执行DHCP Decline攻击测试...
[*] 开始在接口 eth0 上进行 DHCPDECLINE 攻击测试...
[*] 将尝试拒绝 3 个IP地址。

--- 第 1/3 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

--- 第 2/3 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

--- 第 3/3 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

[*] 测试DHCP服务器恢复速度...
[*] 恢复测试 #1，尝试获取新IP...
[+] 服务器已恢复! 可以分配新的IP地址: 172.21.124.144
[+] 恢复时间: 1.03 秒

[*] 测试完成。
[*] 共计拒绝了以下 IP 地址: ['172.21.124.144', '172.21.124.144', '172.21.124.144']

[*] 执行快速释放与重申请测试...
[*] 开始在接口 eth0 上进行快速释放/重申请攻击测试...
[*] 将执行 5 个循环。

--- 第 1/5 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.035秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.068秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 1 轮完成, 用时: 2.096秒

--- 第 2/5 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.028秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.027秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.056秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 2 轮完成, 用时: 2.092秒

--- 第 3/5 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.036秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.068秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 3 轮完成, 用时: 2.100秒

--- 第 4/5 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.064秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 4 轮完成, 用时: 2.096秒

--- 第 5/5 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.064秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 5 轮完成, 用时: 2.096秒

[*] 测试完成。
[*] 在测试期间，服务器共分配了 1 个不同的 IP 地址
[*] IP重用率: 80.0% (越高越好，表示服务器能有效回收IP)
[*] 平均响应时间: 2.064秒
[*] 状态机弹性评分: 6.2/10

================================================================================
DHCP 测试报告: DHCP服务器状态机安全测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
attack_vectors           : []
combined_security_score  : 7.3
decline_test             : {'declined_ips': ['172.21.124.144', '172.21.124.144', '172.21.124.144'], 'total_declined': 3, 'address_pool_exhausted': False, 'server_recovery_time': '1.03秒', 'exhaustion_level': 1.6}
rapid_release_test       : {'cycles_completed': 5, 'unique_ips_assigned': 1, 'address_reuse_rate': 80.0, 'avg_response_time': 2.064, 'server_crashed': '否', 'state_machine_resilience': 6.2}
resilience_score         : 6.2
security_assessment      : 良好安全性 - 服务器可以抵抗一般的状态机攻击
security_score           : 8.4
vulnerability_detected   : 否

--- 安全性分析 ---
安全评分: 8.4/10
抵抗力评分: 6.2/10
================================================================================

[>>>] 正在执行测试套件: 'DHCP Decline攻击测试' [<<<]
[*] 开始在接口 eth0 上进行 DHCPDECLINE 攻击测试...
[*] 将尝试拒绝 5 个IP地址。

--- 第 1/5 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

--- 第 2/5 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

--- 第 3/5 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

--- 第 4/5 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

--- 第 5/5 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 172.21.124.144 来自服务器 172.21.127.253
[+] 已发送 DHCP Decline 拒绝地址 172.21.124.144

[*] 测试DHCP服务器恢复速度...
[*] 恢复测试 #1，尝试获取新IP...
[+] 服务器已恢复! 可以分配新的IP地址: 172.21.124.144
[+] 恢复时间: 1.03 秒

[*] 测试完成。
[*] 共计拒绝了以下 IP 地址: ['172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144']

================================================================================
DHCP 测试报告: DHCP Decline攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
address_pool_exhausted   : False
declined_ips             : ['172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144']
exhaustion_level         : 2.6
pool_exhaustion_percentage: 0
security_assessment      : 安全 - 服务器快速恢复
server_recovery_time     : 1.03秒
total_declined           : 5
================================================================================

[>>>] 正在执行测试套件: '快速释放与重申请攻击测试' [<<<]
[*] 开始在接口 eth0 上进行快速释放/重申请攻击测试...
[*] 将执行 10 个循环。

--- 第 1/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.028秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.060秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 1 轮完成, 用时: 2.092秒

--- 第 2/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.029秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.027秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.056秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 2 轮完成, 用时: 2.088秒

--- 第 3/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.064秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 3 轮完成, 用时: 2.096秒

--- 第 4/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.064秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 4 轮完成, 用时: 2.096秒

--- 第 5/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.064秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 5 轮完成, 用时: 2.100秒

--- 第 6/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.064秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 6 轮完成, 用时: 2.100秒

--- 第 7/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.034秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.068秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 7 轮完成, 用时: 2.100秒

--- 第 8/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.036秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.068秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 8 轮完成, 用时: 2.104秒

--- 第 9/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.036秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.031秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.068秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 9 轮完成, 用时: 2.104秒

--- 第 10/10 轮 ---
[+] 发送 DHCP Discover...
[*] 收到 DHCP Offer 响应时间: 1.032秒
[+] 发送 DHCP Request 请求 IP: 172.21.124.144...
[*] 收到 DHCP ACK 响应时间: 1.027秒
[*] 成功获取 IP: 172.21.124.144 总用时: 2.060秒
[+] 立即发送 DHCP Release 释放地址 172.21.124.144...
[*] 第 10 轮完成, 用时: 2.092秒

[*] 测试完成。
[*] 在测试期间，服务器共分配了 1 个不同的 IP 地址
[*] IP重用率: 90.0% (越高越好，表示服务器能有效回收IP)
[*] 平均响应时间: 2.064秒
[*] 状态机弹性评分: 6.6/10

================================================================================
DHCP 测试报告: 快速释放与重申请攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
address_reuse_rate       : 90.0
assigned_ips             : ['172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144', '172.21.124.144']
avg_response_time        : 2.064
cycles_completed         : 10
max_response_time        : 2.068
security_assessment      : 较安全 - 状态机基本健壮
server_crashed           : 否
state_machine_resilience : 6.6
unique_ips_assigned      : 1
================================================================================


[===] VPS DHCP服务器特性和安全分析摘要 [===]

--- 选项支持情况汇总 ---
路由器名称           | 选项12       | 选项81       | 选项114      | 选项121      | DNS注册      | NTP服务      | TFTP服务     | 引导文件      
--------------------------------------------------------------------------------------------------------------
VPS DHCP        | 否          | 否          | 否          | 否          | 否          | 否          | 否          | 否         

--- 安全与边界测试结果 ---
路由器名称           | 最大消息大小(选项57)              | 中继代理信息(选项82)             
----------------------------------------------------------------------
VPS DHCP        | 不遵循                       | 忽略 (Strip)               

--- 状态机与资源管理测试结果 ---
路由器名称           | 伪造释放攻击易受性            | DHCP饥饿攻击抵抗力          | 客户端指定IP策略                
-------------------------------------------------------------------------------------
VPS DHCP        | 否                    | 否                    | 尊重客户端请求 (分配了请求的IP)       

--- 协议实现年代与完整性测试结果 ---
路由器名称           | Rapid Commit    | 用户类别敏感度         | 静态路由(旧)         | 域名搜索列表         
--------------------------------------------------------------------------------
VPS DHCP        | 否               | 无               | 否               | 否              

--- 时空维度安全测试结果 ---
路由器名称           | 续约时序验证          | 续约源验证           | 子网信息泄露          | 拓扑安全级别         
--------------------------------------------------------------------------------
VPS DHCP        | 未测试             | 未测试             | 未测试             | 未测试            

--- 协议方言与结构完整性测试结果 ---
路由器名称           | BOOTP支持         | 协议验证质量          | 选项解析健壮性         | 网络栈健壮性         
--------------------------------------------------------------------------------
VPS DHCP        | 未测试             | 未测试             | 高               | 未测试            
