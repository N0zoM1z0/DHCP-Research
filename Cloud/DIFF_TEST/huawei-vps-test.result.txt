root@ecs-e16b:~/DHCP-Research/Cloud/DIFF_TEST# cat huawei-vps-test.result.txt 

[===] 开始测试目标: VPS DHCP (网卡: eth0) [===]

[>>>] 正在执行测试套件: '标准DORA流程' [<<<]

================================================================================
DHCP 测试报告: 标准DORA流程
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
completeness_score       : 8
lease_time               : 315360000
missing_options          : ['DNS服务器']
name_server              : N/A
router                   : 192.168.0.1
server_ip                : 192.168.0.254
subnet_mask              : 255.255.255.0

--- DHCP服务完整性分析 ---
完整性得分: 8/10
缺少选项: DNS服务器
================================================================================

[>>>] 正在执行测试套件: 'Option 12 主机名测试' [<<<]

================================================================================
DHCP 测试报告: Option 12 主机名测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
dns_registered           : 否
hostname                 : my-test-pc
resolved_ip              : N/A
server_ip                : 192.168.0.254
================================================================================

[>>>] 正在执行测试套件: 'Option 81 FQDN测试' [<<<]

================================================================================
DHCP 测试报告: Option 81 FQDN测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
dns_registered           : 否
fqdn                     : my-fqdn-pc.local
option81_support         : 否
resolved_ip              : N/A
server_ip                : 192.168.0.254
================================================================================

[>>>] 正在执行测试套件: 'Option 114 强制门户测试' [<<<]

================================================================================
DHCP 测试报告: Option 114 强制门户测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
option114_content        : N/A
option114_in_ack         : 否
option114_support        : 否
server_ip                : 192.168.0.254
================================================================================

[>>>] 正在执行测试套件: 'Option 121 静态路由测试' [<<<]

================================================================================
DHCP 测试报告: Option 121 静态路由测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
option121_in_ack         : 否
option121_support        : 否
server_ip                : 192.168.0.254
static_routes            : N/A
================================================================================

[>>>] 正在执行测试套件: '健壮性-未知选项测试' [<<<]

================================================================================
DHCP 测试报告: 健壮性-未知选项测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
response_type            : ACK
robustness_score         : 10
unknown_option_tolerance : 高 (优雅地忽略未知选项)
================================================================================

[>>>] 正在执行测试套件: '健壮性-畸形选项测试' [<<<]

================================================================================
DHCP 测试报告: 健壮性-畸形选项测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
hostname_in_ack          : b'host-192-168-0-3'
malformed_option_handling: 容忍 (接受了畸形请求并处理了声明长度的部分)
robustness_score         : 5
================================================================================

[>>>] 正在执行测试套件: 'Option 61 客户端标识符测试' [<<<]

================================================================================
DHCP 测试报告: Option 61 客户端标识符测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
client_id_priority       : 未知
custom_id_support        : 是
identification_policy    : 基于MAC地址
mac_change_handling      : 拒绝
option61_support         : 是
server_ip                : 192.168.0.254
standard_id_support      : 是
================================================================================

[>>>] 正在执行测试套件: 'Option 60 厂商类型标识符测试' [<<<]
  -- 测试厂商标识: MSFT 5.0
  -- 测试厂商标识: android-dhcp-10
  -- 测试厂商标识: HUAWEI:STB
  -- 测试厂商标识: IPTV_STB
  -- 测试厂商标识: ArubaAP
  -- 测试厂商标识: udhcp 1.19.4

================================================================================
DHCP 测试报告: Option 60 厂商类型标识符测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
analysis                 : []
option43_responses       : {}
option43_support         : 否
special_vci_handling     : 否
test_details             : {'MSFT 5.0': {'status': '成功', 'assigned_ip': '192.168.0.3', 'server_ip': '192.168.0.254', 'vci': 'MSFT 5.0', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'android-dhcp-10': {'status': '成功', 'assigned_ip': '192.168.0.3', 'server_ip': '192.168.0.254', 'vci': 'android-dhcp-10', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'HUAWEI:STB': {'status': '成功', 'assigned_ip': '192.168.0.3', 'server_ip': '192.168.0.254', 'vci': 'HUAWEI:STB', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'IPTV_STB': {'status': '成功', 'assigned_ip': '192.168.0.3', 'server_ip': '192.168.0.254', 'vci': 'IPTV_STB', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'ArubaAP': {'status': '成 功', 'assigned_ip': '192.168.0.3', 'server_ip': '192.168.0.254', 'vci': 'ArubaAP', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}, 'udhcp 1.19.4': {'status': '成功', 'assigned_ip': '192.168.0.3', 'server_ip': '192.168.0.254', 'vci': 'udhcp 1.19.4', 'vci_support': '是', 'option43_in_offer': '否', 'option43_in_ack': '否'}}
vci_handling_description : 路由器接受所有VCI但没有特殊处理
vci_tests_total          : 6
vci_with_option43_responses: 0
================================================================================

[>>>] 正在执行测试套件: 'Option 43 厂商特定信息测试' [<<<]
  -- 测试VCI与Option 43关联: MSFT 5.0
  -- 测试VCI与Option 43关联: IPTV_STB
  -- 测试VCI与Option 43关联: HUAWEI:STB
  -- 测试VCI与Option 43关联: ArubaAP
  -- 测试VCI与Option 43关联: Cisco Systems
  -- 测试VCI与Option 43关联: VOIP
  -- 测试VCI与Option 43关联: UBNT
  -- 测试VCI与Option 43关联: HP AP
  -- 测试VCI与Option 43关联: TP-LINK

================================================================================
DHCP 测试报告: Option 43 厂商特定信息测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
analysis                 : 路由器不对任何测试的厂商ID返回特定信息
option43_responses       : {}
option43_support         : 否
responsive_vci_count     : 0
responsive_vcis          : []
test_details             : {'MSFT 5.0': {'status': '成功', 'vci': 'MSFT 5.0', 'option43_in_offer': ' 否', 'option43_in_ack': '否', 'option43_received': '否'}, 'IPTV_STB': {'status': '成功', 'vci': 'IPTV_STB', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'HUAWEI:STB': {'status': '成功', 'vci': 'HUAWEI:STB', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'ArubaAP': {'status': '成功', 'vci': 'ArubaAP', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'Cisco Systems': {'status': '成功', 'vci': 'Cisco Systems', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'VOIP': {'status': '成功', 'vci': 'VOIP', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': ' 否'}, 'UBNT': {'status': '成功', 'vci': 'UBNT', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'HP AP': {'status': '成功', 'vci': 'HP AP', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}, 'TP-LINK': {'status': '成功', 'vci': 'TP-LINK', 'option43_in_offer': '否', 'option43_in_ack': '否', 'option43_received': '否'}}
vci_tested               : 9
================================================================================

[>>>] 正在执行测试套件: 'Option 42 NTP服务器测试' [<<<]

================================================================================
DHCP 测试报告: Option 42 NTP服务器测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
ntp_analysis             : 未提供NTP服务器
ntp_count                : 0
ntp_server_count         : 0
ntp_servers              : N/A
option42_in_ack          : 否
option42_in_offer        : 否
option42_support         : 否
server_ip                : 192.168.0.254
================================================================================

[>>>] 正在执行测试套件: 'Option 66/67 PXE引导测试' [<<<]

================================================================================
DHCP 测试报告: Option 66/67 PXE引导测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
bootfile_name            : N/A
bootp_file_used          : 否
bootp_siaddr_used        : 是
option66_in_ack          : 是
option66_in_offer        : 是
option66_support         : 是
option67_in_ack          : 否
option67_in_offer        : 否
option67_support         : 否
pxe_support_level        : 部分支持 (仅提供TFTP服务器)
server_ip                : 192.168.0.254
tftp_server              : 192.168.0.254
================================================================================

[>>>] 正在执行测试套件: 'Option 57 最大消息大小测试' [<<<]

================================================================================
DHCP 测试报告: Option 57 最大消息大小测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
ack_size                 : 382
assigned_ip              : 192.168.0.3
compliance_details       : 完全忽略最大消息大小限制
max_size_declared        : 300
offer_size               : 364
option57_compliance      : 不遵循
option_count             : 12
respects_max_size_ack    : 否
respects_max_size_offer  : 否
server_ip                : 192.168.0.254
size_optimization        : 是
================================================================================

[>>>] 正在执行测试套件: 'Option 82 中继代理信息测试' [<<<]

================================================================================
DHCP 测试报告: Option 82 中继代理信息测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
option82_handling        : 忽略 (Strip)
option82_in_ack          : 否
option82_in_offer        : 否
security_posture         : 一般 (接受但不回显，属于宽容模式)
security_score           : 5
server_ip                : 192.168.0.254

--- 安全性分析 ---
安全评分: 5/10
================================================================================

[>>>] 正在执行测试套件: '租约操纵-伪造释放测试' [<<<]
  -- 使用伪造MAC 2c:17:a5:8d:01:33 尝试释放IP 192.168.0.3

================================================================================
DHCP 测试报告: 租约操纵-伪造释放测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
fake_mac_used            : 2c:17:a5:8d:01:33
ip_after_spoof           : 192.168.0.3
original_ip              : 192.168.0.3
same_ip_reused           : 是
security_posture         : 安全 (服务器忽略了来自错误MAC的Release请求)
security_score           : 10
spoof_release_vulnerable : 否

--- 安全性分析 ---
安全评分: 10/10
================================================================================

[>>>] 正在执行测试套件: '资源耗尽-DHCP饥饿攻击测试' [<<<]
  -- 开始执行饥饿攻击测试，将尝试 30 次...
  -- 第 1/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 2/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 3/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 4/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 5/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 6/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 7/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 8/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 9/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 10/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 11/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 12/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 13/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 14/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 15/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 16/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 17/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 18/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 19/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 20/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 21/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 22/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 23/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 24/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 25/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 26/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 27/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 28/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 29/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 第 30/30 次攻击：未收到OFFER，服务器可能已拒绝或地址池已耗尽
  -- 饥饿攻击测试完成，成功消耗了 0 个IP地址
  -- 分配的IP范围: 无 - 无
  -- 使用真实MAC fa:16:3e:ff:57:5a 尝试获取IP...

================================================================================
DHCP 测试报告: 资源耗尽-DHCP饥饿攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
allocated_ips_sample     : []
assigned_ip              : 192.168.0.3
consumed_ip_count        : 0
ip_recycling_mechanism   : 否
ip_reused_from_attack    : 否
legit_client_got_ip      : 是
resilience_score         : 10
reuse_detail             : 服务器使用了未被攻击消耗的IP
starvation_resilience    : 高 (在攻击后合法客户端仍能获取IP)
starvation_test_result   : 服务器具有攻击抵抗力
starvation_vulnerable    : 否

--- 安全性分析 ---
抵抗力评分: 10/10
================================================================================

[>>>] 正在执行测试套件: 'Option 50 客户端指定IP测试' [<<<]
  -- 第一次获取到IP: 192.168.0.3
  -- 已释放IP 192.168.0.3
  -- 尝试在DISCOVER中请求特定IP: 192.168.0.3
  -- 尝试在DISCOVER中请求边界IP: 192.168.0.103

================================================================================
DHCP 测试报告: Option 50 客户端指定IP测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
edge_request_successful  : 是
honored_edge_request     : 否
offered_edge_ip          : 192.168.0.3
option50_policy          : 尊重客户端请求 (分配了请求的IP)
policy_detail            : 服务器接受客户端建议的IP，但仅限于合理范围内
policy_score             : 5
reference_ip             : 192.168.0.3
request_honored          : 是
requested_edge_ip        : 192.168.0.103
requested_ip             : 192.168.0.3
security_posture         : 中等 (接受先前分配的IP建议)
security_score           : 6

--- 安全性分析 ---
安全评分: 6/10
策略评分: 5/10
================================================================================

[>>>] 正在执行测试套件: 'Option 80 快速提交测试' [<<<]
  -- 等待服务器响应，可能是标准的OFFER或直接ACK...
  -- 收到DHCP OFFER，服务器不支持Rapid Commit

================================================================================
DHCP 测试报告: Option 80 快速提交测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
dora_steps               : 4步 (标准DORA)
efficiency_optimization  : 无
note                     : 服务器不支持Rapid Commit，使用了标准的DORA流程
option80_support         : 否
performance_rating       : 5
rapid_commit_enabled     : 否
================================================================================

[>>>] 正在执行测试套件: 'Option 77 用户类别测试' [<<<]
  -- 基准测试: 获得IP 192.168.0.3
  -- 测试用户类: guest
  -- 测试用户类: gaming
  -- 测试用户类: streaming
  -- 测试用户类: iot
  -- 测试用户类: voice
  -- 测试用户类: admin
  -- 测试用户类: work-from-home

================================================================================
DHCP 测试报告: Option 77 用户类别测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
base_ip                  : 192.168.0.3
option77_support         : 否
special_policies_found   : 0
special_user_classes     : []
user_class_responses     : {'guest': {'status': '标准策略', 'assigned_ip': '192.168.0.3', 'note': '与基准配置相同'}, 'gaming': {'status': '标准策略', 'assigned_ip': '192.168.0.3', 'note': '与基准配置相 同'}, 'streaming': {'status': '标准策略', 'assigned_ip': '192.168.0.3', 'note': '与基准配置相同'}, 'iot': {'status': '标准策略', 'assigned_ip': '192.168.0.3', 'note': '与基准配置相同'}, 'voice': {'status': '标准策略', 'assigned_ip': '192.168.0.3', 'note': '与基准配置相同'}, 'admin': {'status': '标准策 略', 'assigned_ip': '192.168.0.3', 'note': '与基准配置相同'}, 'work-from-home': {'status': '标准策略', 'assigned_ip': '192.168.0.3', 'note': '与基准配置相同'}}
user_class_sensitivity   : 无
user_classes_tested      : 7
================================================================================

[>>>] 正在执行测试套件: 'Option 33 静态路由(旧)测试' [<<<]

================================================================================
DHCP 测试报告: Option 33 静态路由(旧)测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
backward_compatibility   : 低
code_age                 : 现代 (仅支持Option 121)
code_age_details         : 路由器DHCP服务不支持老式Option 33，可能是较新的代码库
option33_in_ack          : 否
option33_support         : 否
server_ip                : 192.168.0.254
static_routes            : N/A
================================================================================

[>>>] 正在执行测试套件: 'Option 119 域名搜索列表测试' [<<<]

================================================================================
DHCP 测试报告: Option 119 域名搜索列表测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
dns_flexibility          : 低
dns_integration          : 低
domain_name              : N/A
domain_search_list       : N/A
multi_domain_support     : 否
option119_support        : 否
option15_support         : 否
server_ip                : 192.168.0.254
================================================================================

[>>>] 正在执行测试套件: '租约续订时序攻击测试' [<<<]
  -- 成功获取IP: 192.168.0.3
  -- 租约时间: 315360000秒
  -- 标准续约时间点T1: 157680000.0秒后
  -- 但我们将在获取IP后立即尝试续约...
  -- 监听网络以捕获现有DHCP客户端信息...
  -- 未能通过监听捕获到DHCP客户端，尝试其他方式...
  -- 未能找到其他客户端，将使用模拟数据进行测试...
  -- 使用模拟受害者: IP=192.168.0.149, MAC=bc:10:e2:48:a8:30
  -- 假设服务器IP: 192.168.0.1
  -- 发送伪造的续约请求 (XID: 0x5e18c62c)

================================================================================
DHCP 测试报告: 租约续订时序攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
early_renewal_details    : {'status': '成功', 'assigned_ip': '192.168.0.3', 'original_lease_time': 315360000, 'renewal_response': 'ACK', 'new_lease_time': 315360000, 'early_renewal_permitted': '是', 'timing_strictness': '低 (接受过早续约请求)', 'timing_security': '低', 'time_validation': '否', 'notes': '服务器接受了过早的续约请求，这可能表明它没有进行时序验证'}
early_renewal_permitted  : 是
overall_renewal_security : 中
source_validation        : 是
space_security_level     : 高
spoofed_renewal_details  : {'status': '成功', 'spoofed_ip': '192.168.0.149', 'spoofed_mac': 'bc:10:e2:48:a8:30', 'renewal_response': '无响应', 'spoofing_possible': '否', 'source_validation': '是', 'security_level': '高', 'notes': '服务器正确地忽略了来自错误源的续约请求'}
spoofing_possible        : 否
time_security_level      : 低
time_validation          : 否
================================================================================

[>>>] 正在执行测试套件: '跨子网IP请求测试' [<<<]
  -- 标准DISCOVER获得IP: 192.168.0.3
  -- 当前网络前缀: 192.168.0
  -- 测试伪造中继IP: 10.0.0.1
  -- 测试伪造中继IP: 172.16.0.1
  -- 测试伪造中继IP: 172.31.0.1
  -- 测试伪造中继IP: 10.1.1.1
  -- 测试伪造中继IP: 192.168.10.1

================================================================================
DHCP 测试报告: 跨子网IP请求测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
security_notes           : 服务器正确拒绝了所有伪造中继的请求
standard_network         : 192.168.0
subnet_leakage_detected  : 否
test_details             : [{'fake_relay': '10.0.0.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}, {'fake_relay': '172.16.0.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}, {'fake_relay': '172.31.0.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}, {'fake_relay': '10.1.1.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带 伪造giaddr的请求'}, {'fake_relay': '192.168.10.1', 'response': '无响应', 'subnet_leakage': '否', 'notes': '服务器正确地忽略了带伪造giaddr的请求'}]
tested_relay_ips         : ['10.0.0.1', '172.16.0.1', '172.31.0.1', '10.1.1.1', '192.168.10.1']      
topology_security_level  : 高
================================================================================

[>>>] 正在执行测试套件: 'BOOTP遗留协议回退测试' [<<<]

================================================================================
DHCP 测试报告: BOOTP遗留协议回退测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
assigned_ip              : 192.168.0.3
bootp_support            : 是
code_age                 : 老 (1993-2000, 早期BOOTP扩展)
dhcp_vs_bootp            : 相同IP分配策略
is_pure_bootp            : 是
legacy_code_presence     : 极可能
malformed_bootp_handling : 拒绝响应 (安全)
security_concern         : 低
validation_quality       : 高
================================================================================

[>>>] 正在执行测试套件: '选项重载字段损坏攻击' [<<<]

================================================================================
DHCP 测试报告: 选项重载字段损坏攻击
================================================================================
测试状态: 成功

--- 详细测试结果 ---
parser_robustness        : 高
security_assessment      : 服务器对DHCP选项溢出攻击具有良好的防御能力
server_crashed           : 否
tests_passed             : 5
tests_run                : 5
vulnerabilities          : []
================================================================================

[>>>] 正在执行测试套件: 'IP分片攻击' [<<<]

================================================================================
DHCP 测试报告: IP分片攻击
================================================================================
测试状态: 成功

--- 详细测试结果 ---
final_connectivity       : 正常
network_stack_robustness : 高
security_assessment      : 服务器对IP分片攻击具有良好的防御能力
tests_passed             : 4
tests_run                : 4
vulnerabilities          : []
================================================================================

[>>>] 正在执行测试套件: 'DHCP服务器状态机安全测试' [<<<]
[*] 开始在接口 eth0 上进行DHCP状态机安全测试...

[*] 执行DHCP Decline攻击测试...
[*] 开始在接口 eth0 上进行 DHCPDECLINE 攻击测试...
[*] 将尝试拒绝 3 个IP地址。

--- 第 1/3 轮 ---
[+] 正在发送 DHCP Discover...
[*] 收到 Offer: IP 地址 192.168.0.3 来自服务器 192.168.0.254
[+] 已发送 DHCP Decline 拒绝地址 192.168.0.3

--- 第 2/3 轮 ---
[+] 正在发送 DHCP Discover...
[!] 未收到 DHCP Offer，服务器可能无响应或地址池已空。

[*] 测试DHCP服务器恢复速度...
[*] 恢复测试 #1，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #2，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #3，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #4，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #5，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #6，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #7，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #8，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #9，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #10，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #11，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...
[*] 恢复测试 #12，尝试获取新IP...
[!] 服务器还未恢复，等待5秒后再试...

[*] 测试完成。
[*] 共计拒绝了以下 IP 地址: ['192.168.0.3']

[*] 执行快速释放与重申请测试...
[*] 开始在接口 eth0 上进行快速释放/重申请攻击测试...
[*] 将执行 5 个循环。

--- 第 1/5 轮 ---
[+] 发送 DHCP Discover...
[!] 未收到 DHCP Offer，服务器可能无响应。

[*] 测试完成。
[*] 在测试期间，服务器共分配了 0 个不同的 IP 地址
[*] IP重用率: 0% (越高越好，表示服务器能有效回收IP)
[*] 平均响应时间: 0秒
[*] 状态机弹性评分: 1/10

================================================================================
DHCP 测试报告: DHCP服务器状态机安全测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
attack_vectors           : ['快速释放与重申请攻击']
combined_security_score  : 5.2
decline_test             : {'declined_ips': ['192.168.0.3'], 'total_declined': 1, 'address_pool_exhausted': True, 'server_recovery_time': '超过60秒', 'exhaustion_level': 0.5}
rapid_release_test       : {'cycles_completed': 0, 'unique_ips_assigned': 0, 'address_reuse_rate': 0, 'avg_response_time': 0, 'server_crashed': '否', 'state_machine_resilience': 1}
resilience_score         : 1
security_assessment      : 中等安全性 - 服务器对状态机攻击的抵抗力有限
security_score           : 9.5
vulnerability_detected   : 是

--- 安全性分析 ---
安全评分: 9.5/10
抵抗力评分: 1/10
================================================================================

[>>>] 正在执行测试套件: 'DHCP Decline攻击测试' [<<<]
[*] 开始在接口 eth0 上进行 DHCPDECLINE 攻击测试...
[*] 将尝试拒绝 5 个IP地址。

--- 第 1/5 轮 ---
[+] 正在发送 DHCP Discover...
[!] 未收到 DHCP Offer，服务器可能无响应或地址池已空。

[*] 测试完成。
[*] 共计拒绝了以下 IP 地址: []

================================================================================
DHCP 测试报告: DHCP Decline攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
address_pool_exhausted   : True
declined_ips             : []
pool_exhaustion_percentage: 0
server_recovery_time     : N/A
total_declined           : 0
================================================================================

[>>>] 正在执行测试套件: '快速释放与重申请攻击测试' [<<<]
[*] 开始在接口 eth0 上进行快速释放/重申请攻击测试...
[*] 将执行 10 个循环。

--- 第 1/10 轮 ---
[+] 发送 DHCP Discover...
[!] 未收到 DHCP Offer，服务器可能无响应。

[*] 测试完成。
[*] 在测试期间，服务器共分配了 0 个不同的 IP 地址
[*] IP重用率: 0% (越高越好，表示服务器能有效回收IP)
[*] 平均响应时间: 0秒
[*] 状态机弹性评分: 1/10

================================================================================
DHCP 测试报告: 快速释放与重申请攻击测试
================================================================================
测试状态: 成功

--- 详细测试结果 ---
address_reuse_rate       : 0
assigned_ips             : []
avg_response_time        : 0
cycles_completed         : 0
max_response_time        : 0
security_assessment      : 不安全 - 状态机脆弱
server_crashed           : 否
state_machine_resilience : 1
unique_ips_assigned      : 0
================================================================================


[===] VPS DHCP服务器特性和安全分析摘要 [===]

--- 选项支持情况汇总 ---
路由器名称           | 选项12       | 选项81       | 选项114      | 选项121      | DNS注册      | NTP服务      | TFTP服务     | 引导文件
--------------------------------------------------------------------------------------------------------------
VPS DHCP        | 否          | 否          | 否          | 否          | 否          | 否          | 是          | 否

--- 安全与边界测试结果 ---
路由器名称           | 最大消息大小(选项57)              | 中继代理信息(选项82)
----------------------------------------------------------------------
VPS DHCP        | 不遵循                       | 忽略 (Strip)

--- 状态机与资源管理测试结果 ---
路由器名称           | 伪造释放攻击易受性            | DHCP饥饿攻击抵抗力          | 客户端指定IP策略

-------------------------------------------------------------------------------------
VPS DHCP        | 否                    | 否                    | 尊重客户端请求 (分配了请求的IP)    


--- 协议实现年代与完整性测试结果 ---
路由器名称           | Rapid Commit    | 用户类别敏感度         | 静态路由(旧)         | 域名搜索列表

--------------------------------------------------------------------------------
VPS DHCP        | 否               | 无               | 否               | 否

--- 时空维度安全测试结果 ---
路由器名称           | 续约时序验证          | 续约源验证           | 子网信息泄露          | 拓扑安 全级别
--------------------------------------------------------------------------------
VPS DHCP        | 未测试             | 未测试             | 未测试             | 未测试

--- 协议方言与结构完整性测试结果 ---
路由器名称           | BOOTP支持         | 协议验证质量          | 选项解析健壮性         | 网络栈健 壮性
--------------------------------------------------------------------------------
VPS DHCP        | 是               | 高               | 高               | 高
root@ecs-e16b:~/DHCP-Research/Cloud/DIFF_TEST# 